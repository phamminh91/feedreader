{% extends 'base.html' %}

{% block title %}
    {% if current_user.is_authenticated() %}
        Your feeds
    {% else %}
        Public feeds
    {% endif %}
{% endblock %}

{% block content %}
<div class="row" id="montage" style="text-shadow: 0 1px 0 rgba(0,0,0,.1);padding:8px 10px">
    <span class="lead">
        {% if source %}
          <img width="30" height="30" id="testimg" style="margin-right:10px" src="{{source.provider.favicon}}" alt="">{{source.name}} -
        {% endif %}
        Friday 23rd 2014
    </span>
    <button class="btn btn-md btn-success pull-right" ng-click="main.openSplash()">Open splash</button>
    <a href="#menu-toggle" class="btn btn-default pull-right" id="menu-toggle">Toggle Menu</a>
</div>

<!-- Article -->
<div class="row">
    <div class="col-lg-8" style="padding:10px;border-right:1px solid #eee">
        {% if source %}
            {% for article in rss_articles %}
            <div class="media" style="margin-bottom:5px; line-height:20px">
                <a class="pull-left article-upview" href="{{article.link}}" data-id="{{article.id}}" target="_blank">
                    {% if article.thumbnail_url %}
                    <img class="media-object" width="90" height="90" src="{{article.thumbnail_url}}">
                    {% else %}
                    <img class="media-object" data-src="holder.js/90x90">
                    {% endif %}
                </a>
                <div class="media-body">
                    <h4 class="media-heading">
                        <a href="{{article.link}}" class="article-upview" data-id="{{article.id}}">{{article.title}}</a>
                        <small class="sub">Vote: ({{article.upvote}} | {{article.downvote}})</small>
                        <small class="sub">Views: {{article.views}}</small>
                    </h4>
                    {{article.summary}}
                    <p>
                      <a href="{{url_for('mod_user.add_article', magazine_id=1, article_id='%d' % article.id)}}">Save</a>
                      <a href="#" class="article-upvote text-success" data-id="{{article.id}}">Upvote</a>
                      <a href="#" class="article-downvote text-danger" data-id="{{article.id}}">Downvote</a>
                      <a href="#" class="article-remove-vote text-warning" data-id="{{article.id}}">Remove vote</a>
                    </p>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <pre>
  _______    _       _              _
 |__   __|  (_)     | |            | |
    | | ___  _    __| | ___   ___  | |__   __ _  ___
    | |/ _ \| |  / _` |/ _ \ / __| | '_ \ / _` |/ _ \
    | | (_) | | | (_| | (_) | (__  | |_) | (_| | (_) |
    |_|\___/|_|  \__,_|\___/ \___| |_.__/ \__,_|\___/
            </pre>
        {% endif %}
    </div>
    <!-- End of Article -->

    <!-- Thumbnail -->
    <div class="col-lg-4" style="padding-top:10px">
        <h4>Popular</h4>
        <hr>
        <div class="row">
            <div class="col-md-12">
              {% for article in popular_articles %}
              <div class="media">
                <a class="pull-left article-upview" href="{{article.link}}" data-id="{{article.id}}">
                  <img class="media-object" width="40" height="40" src="{{article.thumbnail_url}}">
                </a>
                <div class="media-body">
                    <h5 class="media-heading">
                        <a href="{{article.link}}" class="article-upview" data-id="{{article.id}}">
                            {{article.title}}
                        </a>
                    </h5>
                    <small class="sub">Vote: ({{article.upvote}} | {{article.downvote}})</small>
                    <small class="sub">Views: {{article.views}}</small>
                    <p>
                        {{article.summary | truncate(60)}}
                    </p>
                </div>
              </div>
              {% endfor %}
            </div>
        </div>
    </div>
    <!-- End of Thumbnail -->
</div>
{% endblock %}